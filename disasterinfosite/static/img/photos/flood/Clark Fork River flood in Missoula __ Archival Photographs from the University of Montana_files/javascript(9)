
cdm.Favorites=cdm.Favorites?cdm.Favorites:{};cdm.Favorites.checkValueDelimiter=":::";cdm.Favorites.checkBoxClass=".cdmFavoritesCheckbox";cdm.Favorites.toUpdate="";cdm.Favorites.singleItemSelector='[id^="cdmFave:::"]';cdm.Favorites.singlePageSelector='[id^="cdmPageFave:::"]';cdm.Favorites.initPageFaveId="";cdm.Favorites.initPageFavePointer="";cdm.Favorites.init=function(){cdm.Favorites.bindFavoritesSelectAll();cdm.Favorites.bindSaveToFavorites();cdm.Favorites.exportSelected();if($(cdm.Favorites.singleItemSelector).length){cdm.Favorites.isAFav=isAFav;}
if($(cdm.Favorites.singlePageSelector).length){cdm.Favorites.isPageAFave=isPageAFave;}
$("#exportOptionsWrapper").sticky({topSpacing:10});}
cdm.Favorites.bindFavoritesSelectAll=function(){$('#cdmFavoritesCheckAll').click(function(){checkUncheck=$(this).is(':checked');$(cdm.Favorites.checkBoxClass).each(function(){if(checkUncheck){$(this).attr('checked',true);}else{$(this).attr('checked',false);}});});}
cdm.Favorites.bindSaveToFavorites=function(){$('#cdmFavoritesSaveSelected').click(function(){if(!$(cdm.Favorites.checkBoxClass).is(":checked")){alert($('#select_items_to_add_text').val());return;}
cdm.Favorites.toUpdate="";$(cdm.Favorites.checkBoxClass).each(function(){if($(this).is(':checked')){cdm.Favorites.buildFavoritesString($(this).attr("id"));}});if($(cdm.Favorites.checkBoxClass).is(":checked")){cdm.Favorites.updateFavorites("searchbrowse");}});$('#cdmFavoritesRemoveSelected').click(function(){if(!$(cdm.Favorites.checkBoxClass).is(":checked")){alert($('#select_items_to_remove_text').val());return;}
var answer=confirm($('#remove_items_confirm_text').val());if(answer==true){cdm.Favorites.toUpdate="";$(cdm.Favorites.checkBoxClass).each(function(){if($(this).is(':checked')){cdm.Favorites.buildFavoritesString($(this).attr("id"));}});if($(cdm.Favorites.checkBoxClass).is(":checked")){cdm.Favorites.removeFavorites('multiple');}}});$('[id^="cdmFave:::"]').each(function(){$(this).click(function(){cdm.Favorites.toUpdate="";favoritesID=$(this).attr('id').split(":::");cdm.Favorites.buildFavoritesString(favoritesID[1]);if(cdm.Favorites.isAFav==="no"){cdm.Favorites.updateFavorites("singleitem");}else{cdm.Favorites.removeFavorites("singleitem");}});});$('[id^="cdmPageFave:::"]').each(function(){$(this).click(function(){cdm.Favorites.toUpdate="";favoritesID=$(this).attr('id').split(":::");cdm.Favorites.buildFavoritesString(favoritesID[1]);if(cdm.Favorites.isPageAFave==="no"){cdm.Favorites.updateFavorites("compoundobject");}else{cdm.Favorites.removeFavorites("compoundobject");}});});}
cdm.Favorites.buildFavoritesString=function(fid){cdm.Favorites.toUpdate+=fid;}
cdm.Favorites.updateFavorites=function(type){if(cdm.Favorites.areCookiesEnabled()==true){$.ajax({url:"/utils/favadd",global:false,type:"POST",data:{ids:cdm.Favorites.toUpdate,type:type},dataType:"json",success:function(msg){if(msg.response==="true"){switch(type){case"singleitem":$(cdm.Favorites.singleItemSelector).children("span").not('.cdmFavoritesRemoveItemText,.cdmFavoritesSaveItemText').removeClass("fav_star_gray").addClass("fav_star_orange");$('.cdmFavoritesSaveItemText').hide()
$('.cdmFavoritesRemoveItemText').show();$(cdm.Favorites.singleItemSelector).attr('title',$('.cdmFavoritesRemoveItemText').html());cdm.Favorites.isAFav="yes";break;case"compoundobject":$(cdm.Favorites.singlePageSelector).children("span").not('.cdmFavoritesRemovePageText,.cdmFavoritesSavePageText').removeClass("fav_star_gray").addClass("fav_star_orange");$('.cdmFavoritesSavePageText').hide()
$('.cdmFavoritesRemovePageText').show();$(cdm.Favorites.singlePageSelector).attr('title',$('.cdmFavoritesRemovePageText').html());cdm.Favorites.isPageAFave="yes";break;case"searchbrowse":$('.cdmFavoritesSaveSelectedText').hide();$('.cdmFavoritesSelectedSavedText').show().css({'color':'orange','font-weight':'bold'}).delay(1000).fadeOut(1200,function(){$('.cdmFavoritesSaveSelectedText').css({'display':'inline','color':'#3399FF','font-weight':'normal'});});break;}}
if(msg.response=="max_reached"){alert(msg.max_reached_msg);}},error:function(request,status,error){alert(request.responseText);}});}else{alert($('#cookies_not_enabled_for_favorites').val());}}
cdm.Favorites.removeFavorites=function(type){$.ajax({url:"/utils/favremove",global:false,type:"POST",data:{ids:cdm.Favorites.toUpdate},dataType:"json",success:function(msg){if(msg.response==="true"&&type==="singleitem"){$(cdm.Favorites.singleItemSelector).children("span").not('.cdmFavoritesRemoveItemText,.cdmFavoritesSaveItemText').removeClass("fav_star_orange").addClass("fav_star_gray");$('.cdmFavoritesRemoveItemText').hide();$('.cdmFavoritesSaveItemText').show();$(cdm.Favorites.singleItemSelector).attr('title',$('.cdmFavoritesSaveItemText').html());cdm.Favorites.isAFav="no";}
if(msg.response==="true"&&type==="compoundobject"){$(cdm.Favorites.singlePageSelector).children("span").not('.cdmFavoritesRemovePageText,.cdmFavoritesSavePageText').removeClass("fav_star_orange").addClass("fav_star_gray");$('.cdmFavoritesRemovePageText').hide();$('.cdmFavoritesSavePageText').show();$(cdm.Favorites.singlePageSelector).attr('title',$('.cdmFavoritesSavePageText').html());cdm.Favorites.isPageAFave="no";}
if(msg.response==="true"&&type==="multiple"){window.location.href=window.location.href;}},error:function(request,status,error){alert(request.responseText);}});}
cdm.Favorites.isPageAFavorite=function(favepointer){$.ajax({url:"/utils/ispageafavorite",global:false,type:"POST",data:{pageid:favepointer},dataType:"json",success:function(msg){if(msg.response=="true"){$(cdm.Favorites.singlePageSelector).children("span").not('.cdmFavoritesRemovePageText,.cdmFavoritesSavePageText').removeClass("fav_star_gray").addClass("fav_star_orange");$('.cdmFavoritesSavePageText').hide();$('.cdmFavoritesRemovePageText').show();$(cdm.Favorites.singlePageSelector).attr('title',$('.cdmFavoritesRemovePageText').html());cdm.Favorites.isPageAFave="yes";}else{$(cdm.Favorites.singlePageSelector).children("span").not('.cdmFavoritesRemovePageText,.cdmFavoritesSavePageText').addClass("fav_star_gray").removeClass("fav_star_orange");$('.cdmFavoritesRemovePageText').hide();$('.cdmFavoritesSavePageText').show();$(cdm.Favorites.singlePageSelector).attr('title',$('.cdmFavoritesSavePageText').html());cdm.Favorites.isPageAFave="no";}},error:function(request,status,error){}});}
cdm.Favorites.areCookiesEnabled=function(){var cookieEnabled=(navigator.cookieEnabled)?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!cookieEnabled)
{document.cookie="testcookie";cookieEnabled=(document.cookie.indexOf("testcookie")!=-1)?true:false;}
return(cookieEnabled);}
cdm.Favorites.exportSelected=function(){$('#cdmFavoritesExportSelected').submit(function(){if(!$("input[name='exportType']:checked").length>0){alert($('#select_export_option_text').val());return false;}
if(cdm.Favorites.areCookiesEnabled()!=true){alert($('#cookies_not_enabled_for_favorites').val());return false;}
if(!$(cdm.Favorites.checkBoxClass).is(":checked")){$('input[name=exportstring]').val('');alert($('#select_items_to_export_text').val());return false;}else{cdm.Favorites.toUpdate="";$(cdm.Favorites.checkBoxClass).each(function(){if($(this).is(':checked')){cdm.Favorites.buildFavoritesString($(this).attr("id"));}});$('input[name=exportstring]').val(cdm.Favorites.toUpdate);return true;}});}
$(document).ready(function(){cdm.Favorites.init();});