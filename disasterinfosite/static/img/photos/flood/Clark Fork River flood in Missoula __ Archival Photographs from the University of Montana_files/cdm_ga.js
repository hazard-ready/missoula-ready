
var cdm=cdm?cdm:{};cdm.analytics=cdm.analytics?cdm.analytics:{};cdm.analytics.event=cdm.analytics.event?cdm.analytics.event:{};var DA_ATTR='[data-analytics]',DA_STRING='analytics',SCB_SELECTOR='#search_content_box',ADV_SB_SELECTOR='#advanced_search_button',DEFAULT_EVENT_NON_INTERACTION=true,DOM_SELECTOR_STRING='domSelector',SELECTOR_STRING='selector',CATEGORY_STRING='category',ACTION_STRING='action',LABEL_STRING='label',GA_VAL_STRING='gaVal',SEND_STRING='send',EVENT_STRING='event',CO_CATEGORY_STRING='compound objects',CO_REF_URL_SELECTOR_STRING='#cdm_objectRefUrl',PAGE_REF_URL_SELECTOR_STRING='#cdm_newRefUrl',NAVIGATION_ACTION_STRING='navigation',PAGE_ID_ATTRIBUTE_STRING='page_id',ITEM_ID_STRING='item_id',MENU_STRING='menu',ITEM_STRING='item',CLOSE_STRING='close',OPEN_STRING='open',MDY_STRING='mm/dd/yyyy',CLICK_STRING='click',RETURN_STRING='return',QUERY_STRING='query:',TAG_STRING='tag:',OPTION_STRING='option:',UNDEFINED_STRING='undefined',MOUSEDOWN_STRING='mousedown',KEYDOWN_STRING='keydown',QUERY_CONCATENATOR='+',URL_DELIMITER='/',LEFT_CLICK_KEY_CODE=1,ENTER_KEY_CODE=13,gaTrackerNamespaces=[];cdm.analytics.event.bindEvent=function(selector,eventType,keyCode){$(selector).bind(eventType,function(e){var code=e.which;if(code===keyCode){cdm.analytics.event.prepareEvent(this);}});};cdm.analytics.event.prepareEvent=function(dataObj){var category='',action='',label='',value=1,send=true;category=$(dataObj).data(DA_STRING).category;action=$(dataObj).data(DA_STRING).action;if(($(dataObj).data(DA_STRING).category==='search')&&($(dataObj).data(DA_STRING).action===CLICK_STRING||$(dataObj).data(DA_STRING).action===RETURN_STRING)&&$(dataObj).data(DA_STRING).label.indexOf('within results link')===-1){label=$(SCB_SELECTOR).val()?$(SCB_SELECTOR).val():'empty';label=QUERY_STRING+' '+label;}else if($(dataObj).data(DA_STRING).category==='advanced search'&&$(dataObj).data(DA_STRING).action===CLICK_STRING&&$(dataObj).data(DA_STRING).label!=='clear-all-button'){label=QUERY_STRING+' ';var numSearchRows=$('li.adv_search_row').length;$('li.adv_search_row').each(function(index,element){$(this).find('input.adv_search_str').each(function(){if($(this).val().length===0){$('input.datestring').each(function(){if($(this).val().length===0||$('#adv_search_by_date_container').is(':hidden')){send=false;}});}else{label+=$(this).parent().parent().find('select.adv_search_type_dd').find(":selected").val()+QUERY_CONCATENATOR;label+=$(this).val()+QUERY_CONCATENATOR;label+=$(this).parent().parent().find('select.adv_search_domain_dd').find(":selected").val()+QUERY_CONCATENATOR;if(index!==numSearchRows-1){label+=$(this).parent().parent().find('select.adv_search_and_or_dd').find(":selected").val()+QUERY_CONCATENATOR;}}});});if($('#adv_search_by_date_container').is(':hidden')===false){$('input.datestring').each(function(){if($(this).val()===MDY_STRING&&$(this).is(':hidden')===false){send=false;}});$('#adv_search_date_range').each(function(){label+=$(this).find(":selected").text()+QUERY_CONCATENATOR;label+=$('#datepicker1').val()+QUERY_CONCATENATOR;if($(this).find(":selected").text()==='from'){label+=$('#datepickerTo').text()+QUERY_CONCATENATOR;label+=$('#datepicker2').val()+QUERY_CONCATENATOR;}});}
label=label.substring(0,label.length-1);}else if($(dataObj).data(DA_STRING).category==='advanced search'&&$(dataObj).data(DA_STRING).action==='toggle'){if($(dataObj).data(DA_STRING).label==='advanced-search-link'){if($('#adv_search').is(':hidden')){label=$('#cdm_language_advancedsearch').val()+' link';}else{label=$('#cdm_language_closeadvancedsearch').val()+' link';}}else if($(dataObj).data(DA_STRING).label==='search-by-date-link'){if($('#adv_search_by_date_container').is(':hidden')){label=' '+OPEN_STRING;}else{label=' '+CLOSE_STRING;}
label=$('#adv_search_by_date_link').text()+label;}else{label=$(dataObj).data(DA_STRING).label;}}else if($(dataObj).data(DA_STRING).category==='download'){label=$(dataObj).data(DA_STRING).label;if($('#download_button_arrow, #print_button_arrow').is(":hidden")){label=label.replace(MENU_STRING,ITEM_STRING);action=CLICK_STRING;}
if(!$('#download_button_options_dd_container').is(":hidden")&&$(dataObj).data(DA_STRING).action===OPEN_STRING){action=CLOSE_STRING;}
refUrl=$(PAGE_REF_URL_SELECTOR_STRING).val();if($(dataObj).data(DA_STRING).label==='allpages'){refUrl=$(CO_REF_URL_SELECTOR_STRING).val();}
label=label+': '+refUrl;}else if($(dataObj).data(DA_STRING).category==='print'){label=$(dataObj).data(DA_STRING).label;if($('#cdm_hasprintpdf').val()==="0"||(!$('#print_button_options_dd_content').is(":hidden")&&$('#print_button_options_dd_content div').hasClass('language_option_hover'))){label=label.replace(MENU_STRING,ITEM_STRING);action=CLICK_STRING;}else{if(!$('#print_button_options_dd_container').is(":hidden")){action=CLOSE_STRING;}else{action=OPEN_STRING;}}
refUrl=$(PAGE_REF_URL_SELECTOR_STRING).val();if(($(dataObj).data(DA_STRING).label==='all'||$(dataObj).data(DA_STRING).label==='subset'||$(dataObj).data(DA_STRING).label===MENU_STRING)&&!$('#print_button').hasClass('menu_button_hover')){refUrl=$(CO_REF_URL_SELECTOR_STRING).val();}
label=label+': '+refUrl;}else if($(dataObj).data(DA_STRING).category==='compound objects'&&($(dataObj).data(DA_STRING).label==='content'||$(dataObj).data(DA_STRING).label==='thumbnails')){action=$(dataObj).data(DA_STRING).action+': '+$(CO_REF_URL_SELECTOR_STRING).val();label=$(dataObj).data(DA_STRING).label;}else if($(dataObj).data(DA_STRING).category==='page flip'){label=$('.pageFlipViewButton').attr('id')==='pdfPageFlipView'?'PDF':'image';label=label+': '+$(PAGE_REF_URL_SELECTOR_STRING).val();;}else{label=$(dataObj).data(DA_STRING).label;}
if(send){cdm.analytics.event.sendEvent(category,action,label,value);}};cdm.analytics.event.sendEvent=function(category,action,label,value){ga(SEND_STRING,EVENT_STRING,category,action,label,{'eventValue':value,'nonInteraction':DEFAULT_EVENT_NON_INTERACTION});var numAdditionalTrackers=gaTrackerNamespaces.length;for(var j=0;j<numAdditionalTrackers;j++){ga(gaTrackerNamespaces[j]+'.'+SEND_STRING,EVENT_STRING,category,action,label,{'eventValue':value,'nonInteraction':DEFAULT_EVENT_NON_INTERACTION});}};cdm.analytics.init=function(){cdm.analytics.event.bindEvent('#simple_search_button'+DA_ATTR+','+SCB_SELECTOR+DA_ATTR+','+ADV_SB_SELECTOR+DA_ATTR,KEYDOWN_STRING,ENTER_KEY_CODE);cdm.analytics.event.bindEvent(DA_ATTR+':not('+SCB_SELECTOR+')',MOUSEDOWN_STRING,LEFT_CLICK_KEY_CODE);cdm.analytics.event.bindEventsToDynamicHtml();if($("#cdm_view").val()!==undefined){if($("#cdm_view").val()===cdm.gvars.compoundObjectString||$("#cdm_view").val()===cdm.gvars.fullBrowserString){cdm.analytics.event.bindEventsToCompoundObjectNavigation();}}};cdm.analytics.event.bindEventsToCompoundObjectNavigation=function(){var itemId='',label='',refUrl=$('link[rel="canonical"]').attr('href'),action=NAVIGATION_ACTION_STRING+': '+refUrl,pageRefUrl=refUrl!==undefined?refUrl.substring(0,refUrl.lastIndexOf(URL_DELIMITER)):'';$('a.co-page-link').each(function(){$(this).bind(MOUSEDOWN_STRING,function(e){if(typeof $(this).attr(PAGE_ID_ATTRIBUTE_STRING)!==UNDEFINED_STRING&&$(this).attr(PAGE_ID_ATTRIBUTE_STRING)!==false){itemId=$(this).attr(PAGE_ID_ATTRIBUTE_STRING);}else{itemId=$(this).attr(ITEM_ID_STRING);}
label=pageRefUrl+URL_DELIMITER+itemId;var code=e.which;if(code===LEFT_CLICK_KEY_CODE||code===ENTER_KEY_CODE){cdm.analytics.event.sendEvent(CO_CATEGORY_STRING,action,label);}});});};cdm.analytics.event.bindEventsToDynamicHtml=function(){var gaData={'ratings':{'domSelector':'#link_bar_star_container','selector':'div.star-rating-live a','category':'ratings','action':'click','label':'star','gaVal':'star-value'},'saveTagButton':{'domSelector':'#tag_add_div','selector':'#save_tags_button','category':'tags','action':'click','label':'save-button','gaVal':''},'cancelTagLink':{'domSelector':'#tag_add_div','selector':'#tag_add_cancel','category':'tags','action':'click','label':'cancel-and-close-link','gaVal':''},'tagLinksList':{'domSelector':'#cdm_tagList','selector':'li a.cdm_tag_item','category':'tags','action':'click','label':'tag:','gaVal':''},'share':{'domSelector':'body','selector':'#at_hover a span, #at16ps a span','category':'share','action':'click','label':'option:','gaVal':''},'postCommentsButton':{'domSelector':'#comment_add_div','selector':'#comment_add_save','category':'comments','action':'click','label':'post-comment-button','gaVal':''},'cancelCommentLink':{'domSelector':'#comment_add_div','selector':'#comment_add_cancel','category':'comments','action':'click','label':'cancel-and-close-link','gaVal':''}};var label='';var gaVal='';$.each(gaData,function(key,value){$(value[DOM_SELECTOR_STRING]).bind(MOUSEDOWN_STRING+' '+KEYDOWN_STRING,value[SELECTOR_STRING],function(e){if(value[LABEL_STRING]===TAG_STRING||value[LABEL_STRING]===OPTION_STRING){label=value[LABEL_STRING]+' '+$(this).text();}else{label=value[LABEL_STRING];}
if(value[GA_VAL_STRING]==='star-value'){gaVal=$(this).text();label='star-'+$(this).text();}
var code=e.which;if(code===LEFT_CLICK_KEY_CODE||code===ENTER_KEY_CODE){cdm.analytics.event.sendEvent(value[CATEGORY_STRING],value[ACTION_STRING],label,gaVal);}});});};$(document).ready(function(){cdm.analytics.init();});